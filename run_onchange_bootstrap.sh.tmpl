#!/bin/bash

# .bootstrap/setup.yml hash: {{ include "dot_bootstrap/setup.yml" | sha256sum }}

# Install Ansible if not present
if ! command -v ansible-playbook &> /dev/null; then
    case "$(uname -s)" in
        Linux*)
            if [ -f /etc/fedora-release ]; then
                sudo dnf install -y ansible
            elif [ -f /etc/lsb-release ]; then
                sudo apt-get update
                sudo apt-get install -y ansible
            fi
            ;;
        Darwin*)
            brew install ansible
            ;;
    esac
fi

# Run ansible playbook
ansible-playbook {{ joinPath .chezmoi.sourceDir "dot_bootstrap/setup.yml" | quote }} --ask-become-pass


